ARG BUILD_FROM=ghcr.io/hassio-addons/base-nodejs:0.2.2
# hadolint ignore=DL3006
FROM $BUILD_FROM

ARG MATTERBRIDGE_VERSION=1.2.21
ARG MATTERBRIDGE_HOME_ASSISTANT_VERSION=0.0.5

EXPOSE 8283
EXPOSE 8284

RUN mkdir /app
WORKDIR /app

RUN ln -s /config /root/.matterbridge

COPY package.json package.json
COPY package-lock.json package-lock.json
RUN npm ci

COPY run.sh run.sh
RUN chmod a+x run.sh

CMD [ "run.sh" ]
